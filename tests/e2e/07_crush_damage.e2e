# Test crush damage at critical density (agents caged so they can't flee)
reset_game
set_spawn_enabled 0
wait_frames 2

# Build a fence cage around (25,25) so agents can't flee
set_tile 24 25 fence
set_tile 26 25 fence
set_tile 25 24 fence
set_tile 25 26 fence
wait_frames 2

# Spawn 40 agents on one tile (critical density)
spawn_agents 25 25 40 stage
wait_frames 2

# Before deaths
assert_death_count eq 0
screenshot 07_before_deaths

# Wait ~6 seconds for deaths (1 HP / 0.2 per sec = 5 sec)
wait 6

# Deaths should have occurred
assert_death_count gt 0
screenshot 07_after_deaths
get_death_count
